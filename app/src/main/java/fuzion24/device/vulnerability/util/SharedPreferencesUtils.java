package fuzion24.device.vulnerability.util;

import android.content.Context;
import android.content.SharedPreferences;

import java.util.Arrays;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class SharedPreferencesUtils {

    private static final String PREFS_LAST_LIST_OF_SCANS = "PREFS_LIST_OF_SCANS";


    private static final String PREFS_NAME = "com.nowsecure.android.vts.PREFERENCE_FILE_KEY";

    private static SharedPreferences getPreferences(Context context) {
        return context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);
    }

    public static List<String> getTheListOfScansAvailable(Context context) {
        Set<String> listOfPreviousScans = getPreferences(context).getStringSet(PREFS_LAST_LIST_OF_SCANS, null);

        if (listOfPreviousScans == null) {
            return null;
        }

        List<String> listOfScans = Arrays.asList(listOfPreviousScans.toArray(new String[listOfPreviousScans.size()]));

        return listOfScans;
    }

    public static void setTheListOfScansAvailable(Context context, List<String> listOfScans) {
        SharedPreferences.Editor editor = getPreferences(context).edit();

        editor.putStringSet(PREFS_LAST_LIST_OF_SCANS, new HashSet<>(listOfScans));

        editor.apply();
    }

}
